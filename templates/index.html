<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robotix Japan - Filo Drone</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="/static/css/codemirror.min.css">
    <style>
    /* Custom Status Indicators */
    .status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 8px;
    }
    .status-connected { background-color: #10b981; }
    .status-disconnected { background-color: #ef4444; }
    .status-executing { background-color: #f59e0b; animation: pulse 1s infinite; }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    </style>
</head>
<body class="bg-gray-100 h-screen flex flex-col">
  
  <!-- Top bar -->
  <header class="flex items-center justify-between bg-white shadow px-6 py-4">
    <h1 class="text-xl font-bold">Robotix Japan</h1>
    <a href="/filo" class="text-lg font-bold text-blue-500 hover:underline">üì± Manual Control</a>

    <div class="flex items-center space-x-4">
      <div id="statusDisplay" class="text-sm">
        <span class="status-indicator status-disconnected"></span>
        <span id="statusText">Disconnected</span>
      </div>
      <button id="centerBtn" class="p-3 bg-gray-200 hover:bg-gray-300 rounded-full text-lg" title="Center workspace">üåÄ</button>
      <button id="stopBtn" class="p-3 bg-red-500 hover:bg-red-600 text-white rounded-full text-lg hidden" title="Emergency Stop">‚èπÔ∏è STOP</button>
      <button id="startBtn" class="p-3 bg-green-500 hover:bg-green-600 text-white rounded-full text-lg">‚ñ∂ Start</button>
    </div>
  </header>

  <!-- Content -->
  <main class="flex-1 flex overflow-hidden">
    <!-- Blockly workspace -->
    <div id="blocklyDiv" style="width: 70%"></div>

    <!-- Python code panel -->
    <div id="codePanel" class="w-[30%] bg-[#2d2d2d] text-white flex flex-col">
      <div class="flex justify-between items-center bg-[#1e1e1e] px-4 py-2 border-b border-gray-700">
        <span class="text-sm">Python Code</span>
        <div class="space-x-0">
          <button id="generateBtn" class="bg-blue-500 hover:bg-blue-600 text-white text-sm px-3 py-1 rounded">
            Generate
          </button>
          <button id="loadBlocks" class="bg-purple-500 hover:bg-purple-600 text-white text-sm px-3 py-1 rounded">
            Load Blocks
          </button>
        </div>
      </div>
      <textarea id="codeEditor"></textarea>
      
      <!-- Console output -->
      <div class="bg-[#1e1e1e] border-t border-gray-700 p-3 h-32 overflow-y-auto">
        <div class="text-xs text-gray-400 mb-1">Console:</div>
        <div id="console" class="text-xs text-green-400 font-mono"></div>
      </div>
    </div>
  </main>

  <!-- Toolbox -->
  <xml id="toolbox" style="display: none">
    <!-- MOTION -->
    <category name="Motion" colour="#4CAF50">
      <block type="takeoff"></block>
      <block type="land"></block>
      <block type="stop"></block>
      <block type="emergency"></block>
      <block type="up"></block>
      <block type="down"></block>
      <block type="forward"></block>
      <block type="back"></block>
      <block type="left"></block>
      <block type="right"></block>
      <block type="rotate_cw"></block>
      <block type="rotate_ccw"></block>
      <block type="flip_front"></block>
      <block type="flip_back"></block>
      <block type="flip_left"></block>
      <block type="flip_right"></block>
      <block type="setspeed"></block>
      <block type="go"></block>
      <block type="curve"></block>
    </category>
  
    <!-- CONTROL -->
    <category name="Control" colour="#FF9800">
      <block type="controls_if"></block>
      <block type="controls_repeat_ext"></block>
      <block type="controls_whileUntil"></block>
      <block type="controls_for"></block>
      <block type="controls_flow_statements"></block>
      <block type="wait_seconds"></block>
    </category>
  
    <!-- LIGHT -->
    <category name="Light" colour="#E91E63">
      <block type="led_color"></block>
      <block type="led_rgb"></block>
      <block type="led_breathe"></block>
      <block type="led_flash"></block>
    </category>

    <!-- CAMERA -->
    <category name="Camera" colour="#9C27B0">
      <block type="photo"></block>
      <block type="record_start"></block>
      <block type="record_stop"></block>
    </category>
  
    <!-- OPERATOR -->
    <category name="Logic" colour="%{BKY_LOGIC_HUE}">
      <!-- <block type="controls_if"></block> -->
      <block type="logic_compare"></block>
      <block type="logic_operation"></block>
      <block type="logic_negate"></block>
      <block type="logic_boolean"></block>
    </category>

    <category name="Loops" colour="%{BKY_LOOPS_HUE}">
      <block type="controls_repeat_ext">
        <value name="TIMES">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
      </block>
      <block type="controls_whileUntil"></block>
    </category>

    <category name="Math" colour="%{BKY_MATH_HUE}">
      <block type="math_number">
        <field name="NUM">123</field>
      </block>
      <block type="math_arithmetic"></block>
      <block type="math_single"></block>
    </category>

    <category name="Text" colour="%{BKY_TEXTS_HUE}">
      <block type="text"></block>
      <block type="text_length"></block>
      <block type="text_print"></block>
    </category>
  
    <!-- VARIABLES -->
    <category name="Variables" custom="VARIABLE" colour="%{BKY_VARIABLES_HUE}"></category>
  
    <!-- SENSING -->
    <category name="Sensing" colour="#9C27B0">
      <block type="battery_level"></block>
      <block type="wifi_signal"></block>
      <block type="altitude"></block>
    </category>
  </xml>

  <!-- SCRIPTS -->
  <!-- CodeMirror -->
  <script src="/static/js/codemirror.min.js"></script>
  <script src="/static/js/python.min.js"></script>

  <!-- Blockly -->
  <script src="/static/js/blockly.min.js"></script>
  <script src="/static/js/msg/en.js"></script>
  <script src="/static/js/blocks_compressed.js"></script>
  <script src="/static/js/python_compressed.js"></script>

  <!-- Main Application Logic -->
  <script src="/static/js/main.js"></script>

</body>
</html>